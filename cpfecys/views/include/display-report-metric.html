<!--#****************************************************************************-->
<!--#****************************PHASE 2 DTT Metrics Section*********************-->
{{if report.assignation.project.area_level.name == 'DTT Tutor Académico' and (report.status == 1 or report.status == 3):}}
    {{metric = inc_vars['metric']}}
    <div class="row-fluid">
        <div class="well col-12">
            <div class="row">
                <div class="col-12">
                    <strong>{{=T('Date')}}:</strong> {{=metric[0]}}
                </div>
                <div class="col-12">
                    <h2 class="center">{{=db(db.metrics_type.id == metric[16]).select(db.metrics_type.name).first()[db.metrics_type.name]}}</h2>
                    <p>
                        {{=MARKMIN(metric[1], markmin_settings)}}
                    </p>
                    <div class="row">
                        <div class="col-6">
                            <table class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <td>
                                            <strong>{{=T('Metric')}}</strong>
                                        </td>
                                        <td>
                                            <strong>{{=T('Value')}}</strong>
                                        </td>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>{{=T('Media')}}</strong> </td>
                                        <td>{{=metric[2]}}</td></tr>
                                    <tr><td><strong>{{=T('Error')}}</strong> </td>
                                        <td>{{=metric[3]}}</td></tr>
                                    <tr><td><strong>{{=T('Mediana')}}</strong></td>
                                        <td> {{=metric[4]}}</td></tr>
                                    <tr><td><strong>{{=T('Moda')}}</strong> </td>
                                        <td>{{=metric[5]}}</td></tr>
                                    <tr><td><strong>{{=T('Desviacion')}}</strong></td>
                                        <td> {{=metric[6]}}</td></tr>
                                    <tr><td><strong>{{=T('Varianza')}}</strong></td>
                                        <td> {{=metric[7]}}</td></tr>
                                    <tr><td><strong>{{=T('Curtosis')}}</strong></td>
                                        <td> {{=metric[8]}}</td></tr>
                                    <tr><td><strong>{{=T('Coeficiente')}}</strong></td>
                                        <td> {{=metric[9]}}</td></tr>
                                    <tr><td><strong>{{=T('Rango')}}</strong> </td>
                                        <td>{{=metric[10]}}</td></tr>
                                    <tr><td><strong>{{=T('Minimo')}}</strong> </td>
                                        <td>{{=metric[11]}}</td></tr>
                                    <tr><td><strong>{{=T('Maximo')}}</strong> </td>
                                        <td>{{=metric[12]}}</td></tr>
                                    <tr><td><strong>{{=T('Total')}}</strong> </td>
                                        <td>{{=metric[13]}}</td></tr>
                                    <tr><td><strong>{{=T('Reprobados')}}</strong></td>
                                        <td> {{=metric[14]}}</td></tr>
                                    <tr><td><strong>{{=T('Aprobados')}}</strong></td>
                                        <td> {{=metric[15]}}</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="col-6 center">
                            <div>
                                <h3></h3>
                                <div style="width:100%; height:300px;" id="graphpie{{=metric[17]}}"></div>
                            </div>
                            <div>
                                <div class="mt-2" style="width:100%; height:300px;" id="graphbars{{=metric[17]}}"></div>
                            </div>
                            {{if metric[13] > 0:}}
                            <script type="text/javascript">
                                $(function () {
                                    new Highcharts.Chart({
                                        chart: {
                                            renderTo: 'graphpie{{=metric[17]}}',
                                            plotBackgroundColor: null,
                                            plotBorderWidth: null,
                                            plotShadow: false
                                        },
                                        title: {
                                            text: 'Aprobados vs. Reprobados'
                                        },
                                        tooltip: {
                                            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                                        },
                                        plotOptions: {
                                            pie: {
                                                allowPointSelect: true,
                                                cursor: 'pointer',
                                                dataLabels: {
                                                    enabled: true,
                                                    color: '#000000',
                                                    connectorColor: '#000000',
                                                    format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                                                }
                                            }
                                        },
                                        series: [{
                                            type: 'pie',
                                            name: 'Aprobados vs. Reprobados',
                                            data: [
                                                ['Aprobados', {{=100.0 * metric[15] / metric[13]}}],
                                                ['Reprobados', {{=100.0 * metric[14] / metric[13]}}]
                                            ]
                                        }]
                                    });

                                    new Highcharts.Chart({
                                        chart: {
                                            renderTo: 'graphbars{{=metric[17]}}',
                                            type: 'column',
                                            margin: [ 50, 50, 100, 80]
                                        },
                                        title: {
                                            text: 'Aprobados vs. Reprobados'
                                        },
                                        xAxis: {
                                            categories: [
                                                'Aprobados',
                                                'Reprobados'
                                            ],
                                            labels: {
                                                rotation: -45,
                                                align: 'right',
                                                style: {
                                                    fontSize: '13px',
                                                    fontFamily: 'Verdana, sans-serif'
                                                }
                                            }
                                        },
                                        yAxis: {
                                            min: 0,
                                            title: {
                                                text: 'Estudiantes'
                                            }
                                        },
                                        legend: {
                                            enabled: false
                                        },
                                        tooltip: {
                                            pointFormat: 'Estudiantes: <b>{point.y:.1f}</b>',
                                        },
                                        series: [{
                                            name: 'Estudiantes',
                                            data: [{{=metric[15]}}, {{=metric[14]}}],
                                            dataLabels: {
                                                enabled: true,
                                                rotation: -90,
                                                color: '#FFFFFF',
                                                align: 'right',
                                                x: 4,
                                                y: 10,
                                                style: {
                                                    fontSize: '13px',
                                                    fontFamily: 'Verdana, sans-serif',
                                                    textShadow: '0 0 3px black'
                                                }
                                            }
                                        }]
                                    });
                                });
                            </script>
                            {{pass}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{{else:}}
    {{metric = inc_vars['metric']}}
    <div class="row-fluid">
        <div class="well span12">
            <div class="col-12">
                <strong>{{=T('Date')}}:</strong> {{=metric.created}}
                {{if inc_vars['editable']:}}
                    <div class="pull-right">
                        <div class="btn-group">
                            <a href="#{{=inc_vars['edit_action']}}"
                            data-toggle="modal" class="btn btn-primary">
                                <span class="fa fa-pencil"></span>
                            </a>
                            <a href="#{{=inc_vars['delete_action']}}"
                            data-toggle="modal" class="btn btn-danger">
                                <span class="fa fa-trash"></span>
                            </a>
                        </div>
                    </div>
                {{pass}}
            </div>
            <div class="col-12">
                <h2 class="center">{{=metric.metrics_type.name}}</h2>
                <p>
                    {{=MARKMIN(metric.description, markmin_settings)}}
                </p>
                <div class="col-6">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <td><strong>Métrica</strong></td>
                                <td><strong>Valor</strong></td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Media</strong></td>
                                <td>{{=metric.media}}</td>
                            </tr>
                            <tr>
                                <td><strong>Error</strong></td>
                                <td>{{=metric.error}}</td>
                            </tr>
                            <tr>
                                <td><strong>Mediana</strong></td>
                                <td>{{=metric.mediana}}</td>
                            </tr>
                            <tr>
                                <td><strong>Moda</strong></td>
                                <td>{{=metric.moda}}</td>
                            </tr>
                            <tr>
                                <td><strong>Desviación</strong></td>
                                <td>{{=metric.desviacion}}</td>
                            </tr>
                            <tr>
                                <td><strong>Varianza</strong></td>
                                <td>{{=metric.varianza}}</td>
                            </tr>
                            <tr>
                                <td><strong>Curtosis</strong></td>
                                <td>{{=metric.curtosis}}</td>
                            </tr>
                            <tr>
                                <td><strong>Coeficiente</strong></td>
                                <td>{{=metric.coeficiente}}</td>
                            </tr>
                            <tr>
                                <td><strong>Rango</strong></td>
                                <td>{{=metric.rango}}</td>
                            </tr>
                            <tr><td><strong>Mínimo</strong></td>
                                <td>{{=metric.minimo}}</td>
                            </tr>
                            <tr>
                                <td><strong>Máximo</strong></td>
                                <td>{{=metric.maximo}}</td>
                            </tr>
                            <tr>
                                <td><strong>Total</strong></td>
                                <td>{{=metric.total}}</td>
                            </tr>
                            <tr>
                                <td><strong>Reprobados</strong></td>
                                <td>{{=metric.reprobados}}</td>
                            </tr>
                            <tr>
                                <td><strong>Aprobados</strong></td>
                                <td>{{=metric.aprobados}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-6">
                    <div>
                        <h3>
                        </h3>
                        <div style="width:100%; height:300px;" id="graphpie{{=metric.id}}"></div>
                    </div>
                    <div>
                        <div style="width:100%; height:300px;" id="graphbars{{=metric.id}}"></div>
                    </div>
                    {{if metric.total > 0:}}
                    <script type="text/javascript">
                        $(function () {
                            new Highcharts.Chart({
                                chart: {
                                    renderTo: 'graphpie{{=metric.id}}',
                                    plotBackgroundColor: null,
                                    plotBorderWidth: null,
                                    plotShadow: false
                                },
                                title: {
                                    text: 'Aprobados vs. Reprobados'
                                },
                                tooltip: {
                                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                                },
                                plotOptions: {
                                    pie: {
                                        allowPointSelect: true,
                                        cursor: 'pointer',
                                        dataLabels: {
                                            enabled: true,
                                            color: '#000000',
                                            connectorColor: '#000000',
                                            format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                                        }
                                    }
                                },
                                series: [{
                                    type: 'pie',
                                    name: '{{=T("Aproved vrs. Failed Students")}}',
                                    data: [
                                        ['{{=T("Aproved")}}',   {{=100.0*metric.aprobados/metric.total}}],
                                        ['{{=T("Failed")}}',   {{=100.0*metric.reprobados/metric.total}}]
                                    ]
                                }]
                            });

                            new Highcharts.Chart({
                                chart: {
                                    renderTo: 'graphbars{{=metric.id}}',
                                    type: 'column',
                                    margin: [ 50, 50, 100, 80]
                                },
                                title: {
                                    text: '{{=T("Aproved vrs. Failed Students")}}'
                                },
                                xAxis: {
                                    categories: [
                                        '{{=T("Aproved")}}',
                                        '{{=T("Failed")}}'
                                    ],
                                    labels: {
                                        rotation: -45,
                                        align: 'right',
                                        style: {
                                            fontSize: '13px',
                                            fontFamily: 'Verdana, sans-serif'
                                        }
                                    }
                                },
                                yAxis: {
                                    min: 0,
                                    title: {
                                        text: '{{=T("Students")}}'
                                    }
                                },
                                legend: {
                                    enabled: false
                                },
                                tooltip: {
                                    pointFormat: '{{=T("Students")}}: <b>{point.y:.1f}</b>',
                                },
                                series: [{
                                    name: '{{=T("Students")}}',
                                    data: [{{=metric.aprobados}},
                                           {{=metric.reprobados}}],
                                    dataLabels: {
                                        enabled: true,
                                        rotation: -90,
                                        color: '#FFFFFF',
                                        align: 'right',
                                        x: 4,
                                        y: 10,
                                        style: {
                                            fontSize: '13px',
                                            fontFamily: 'Verdana, sans-serif',
                                            textShadow: '0 0 3px black'
                                        }
                                    }
                                }]
                            });
                        });
                    </script>
                    {{pass}}
                </div>
            </div>
        </div>
    </div>
{{pass}}
<!--#****************************************************************************-->
<!--#****************************PHASE 2 DTT x*************************************-->