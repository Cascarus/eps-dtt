{{extend 'dashboard.html'}}
<!-- Additional Scripts for MARKMIN -->
<script src="http://code.jquery.com/jquery-migrate-1.2.1.js"></script>
<script type="text/javascript" src="{{=URL('static','markitup')}}/jquery.markitup.pack.js"></script>
<script type="text/javascript" src="{{=URL('static','markitup')}}/sets/markmin/set.js"></script>
<script type="text/javascript" src="{{=URL('static','js')}}/highcharts/js/highcharts.js"></script>
<script type="text/javascript" src="{{=URL('static','js')}}/highcharts/js/modules/data.js"></script>
<script type="text/javascript" src="{{=URL('static','js')}}/highcharts/js/modules/exporting.js"></script>
<link rel="stylesheet" type="text/css" href="{{=URL('static','markitup')}}/skins/markitup/style.css"/>
<link rel="stylesheet" type="text/css" href="{{=URL('static','markitup')}}/sets/markmin/style.css"/>
<!-- //Additional Scripts for MARKMIN -->

<div class="mt-4">
	<div class="row">
    	<!--REPORT CONTENTS-->
    	<div class="col-12">
    		<!--HEADER OF REPORT-->
	    	{{if request.vars['level'] is not None and str(request.vars['level']) != "1":}}
				<div class="pull-left">
					<a style="white-space:nowrap; cursor:pointer; align:right;" class="btn btn-primary" onclick="levelUP();">
						<span class="icon-black icon-arrow-up"></span><b>Subir nivel</b>
					</a>
				</div>
	    	{{pass}}
	    	<div class="pull-right">
	    		<a class='btn btn-success' onclick="exportCSV();"><img src="{{=URL('static','images')}}/icono_CSV.png"></a>
	    	</div>
	    	<center><h1>Resumen de reporte</h1></center>
	    	<hr>
	    	<img class="pull-right" src="{{=URL('static','images')}}/escudo.png">
			<center>
				<strong>Universidad de San Carlos de Guatemala</strong><br/>
				<strong>Facultad de Ingeniería</strong><br/>
				<strong>Escuela de Ingeniería en Ciencias y Sistemas</strong>
			</center><br/>
			<table>
				<tr>
					<td><strong>Tipo</strong></td>
					<td>Histórico por curso</td>
				</tr>
				<tr>
					<td><strong>Descripción</strong></td>
					<td>Reporte sobre la información historica de los cursos.</td>
				</tr>
				<tr>
					<td><strong>Periodo</strong></td>
					<td>{{=T(period.period.name)}} {{=period.yearp}}</td>
				</tr>
			</table>
			<!--HEADER OF REPORT-->
			{{if request.vars['level'] is None or str(request.vars['level']) == "1":}}
				<form class="form-inline" action="{{=URL('school_reports','historic_course')}}" method='get'>
					<select name="period" class="form-control">
						{{for period_i in group_periods:}}
							{{if str(period_i.id) == str(period.id):}}
								{{var_sel = "selected='selected'"}}
							{{else:}}
								{{var_sel = ''}}
							{{pass}}
							<option value="{{=period_i.id}}" {{=var_sel}}>
								{{=T(period_i.period.name)}}-{{=period_i.yearp}}
							</option>
						{{pass}}
					</select>
					<input class="btn btn-primary" type="submit" value="Ir">
				</form>
		  		<!--REPORT IN TABLE-->
				<table class="table table-striped table-bordered">
					<tr>
						<th>Curso</th>
						<th><center>Total de alumnos asignados al curso</center></th>
						<th><center>Aprobaron el curso</center></th>
						<th><center>Reprobaron el curso</center></th>
						<th><center>Número de secciones</center></th>
					</tr>
					{{for project in info_level:}}
						<tr>
							<td>
								<a style="cursor:pointer;" onclick="next_Level({{=project[0]}});">{{=project[1]}}</a>
							</td>
							<td><center>{{=project[2]}}</center></td>
							<td><center>{{=project[3]}}</center></td>
							<td><center>{{=project[4]}}</center></td>
							<td><center>{{=project[5]}}</center></td>
						</tr>
					{{pass}}
				</table>
			<!--REPORT IN TABLE-->
			{{elif str(request.vars['level']) == "2":}}
				<br/><strong>Curso: </strong>{{=project}}<br/><br/>
				<!--REPORT IN TABLE-->
				<table class="table table-striped table-bordered">
					<tr>
						<th>Sección</th>
						<th><center>Total de alumnos asignados al curso</center></th>
						<th><center>Aprobaron el curso</center></th>
						<th><center>Reprobaron el curso</center></th>
					</tr>
					{{for project in info_level:}}
						<tr>
							<td>
								{{=project[0]}}
							</td>
							<td><center>{{=project[1]}}</center></td>
							<td><center>{{=project[2]}}</center></td>
							<td><center>{{=project[3]}}</center></td>
						</tr>
					{{pass}}
				</table>
			<!--REPORT IN TABLE-->
			{{pass}}
    	</div>
		<!--REPORT CONTENTS-->    
	</div>
</div>

<script type="text/javascript">
	{{if request.vars['level'] is None or str(request.vars['level'])=="1":}}
		function next_Level(id){
			window.location.href = "{{=URL('school_reports', 'historic_course')}}?level=2&amp;period={{=period.id}}&amp;project="+id;
		}

		function exportCSV(){
			window.location.href = "{{=URL('school_reports','historic_course_export', vars=dict(list_type='csv', level='1',period = period.id))}}";
		}
	{{else:}}
		function levelUP(){
			window.location.href = "{{=URL('school_reports', 'historic_course')}}?period={{=period.id}}";
		}

		function exportCSV(){
			window.location.href = "{{=URL('school_reports','historic_course_export', vars=dict(list_type='csv', level='2',period = str(request.vars['period']), project = str(request.vars['project'])))}}";
		}
	{{pass}}
</script>
