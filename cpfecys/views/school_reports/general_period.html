{{extend 'dashboard.html'}}
<div class="mt-4">
	<div class="row">
		<div class="col-12">
			<div class="col-12">
				<!--REPORT CONTENTS-->
				<!--HEADER OF REPORT-->
				<div class="pull-right">
					<a class="btn btn-success" onclick="exportCSV();"><img src="{{=URL('static','images')}}/icono_CSV.png"></a>
				</div>
				<center><h1>Resumen de reporte</h1></center>
				<hr>
				<img class="pull-right" src="{{=URL('static', 'images')}}/escudo.png">
				<center>
                    <strong>Universidad de San Carlos de Guatemala</strong><br/>
                    <strong>Facultad de Ingeniería</strong><br/>
                    <strong>Escuela de Ingeniería en Ciencias y Sistemas</strong>
                </center><br/>
                <table>
                    <tr>
                        <td><strong>Tipo</strong></td>
                        <td>Información general de semestre</td>
                    </tr>
                    <tr>
                        <td><strong>Descripción</strong></td>
                        <td>Reporte sobre la información general de los cursos por semestre.</td>
                    </tr>
                    <tr>
                        <td><strong>Periodo</strong></td>
                        <td>{{=T(period.period.name)}} {{=period.yearp}}</td>
                    </tr>
                </table>
				<form class="form-inline" action="{{=URL('school_reports', 'general_period')}}" method='get'>
					<select name="period" class="form-control">
                        {{for period_i in group_periods:}}
                            {{if period_i.id == period.id:}}
                                {{var_sel = "selected='selected'"}}
                            {{else:}}
                                {{var_sel = ''}}
                            {{pass}}
                            <option value="{{=period_i.id}}" {{=var_sel}}>
                                {{=T(period_i.period.name)}}-{{=period_i.yearp}}
                            </option>
                        {{pass}}
					</select>
					<input class="btn btn-primary" type="submit" value="Ir">
				</form>
				<!--HEADER OF REPORT-->
				<br>
				<!--BODY OF REPORT-->
				<table class="table table-striped table-bordered">
					{{first = True}}
					{{for project in info_level:}}
						<tr>
							{{if first:}}
								{{for field in project:}}
									<td><center><b>{{=field}}</b></center></td>
								{{pass}}
							{{else:}}
								<td><b>{{=project[0]}}</b></td>
								<td><center>{{=project[1]}}</center></td>
								{{for field in range(2, len(project) - 2):}}
									<td>
                                        <center>
                                            {{if float(project[field]) < float(control_p.min_average):}}
                                                <font color="#FA4545">
                                            {{elif float(project[field]) >= float(control_p.min_average) and float(project[field]) <= float(control_p.max_average):}}
                                                <font style="color: #C5B911; text-shadow: -1px -1px 0 #F2F5A9, 1px -1px 0 #F2F5A9, -1px 1px 0 #F2F5A9, 1px 1px 0 #F2F5A9;">
                                            {{else:}}
                                                <font style="color: Green; text-shadow: -1px -1px 0 #CBE9C4, 1px -1px 0 #CBE9C4, -1px 1px 0 #CBE9C4, 1px 1px 0 #CBE9C4;">
                                            {{pass}}
                                                {{=project[field]}}
                                                </font>
									    </center>
                                    </td>
								{{pass}}
								<td>
									<center>
										{{if float(project[len(project)-2]) < float(control_p.min_average):}}
											<span class="badge badge-danger">
										{{elif float(project[len(project)-2]) >= float(control_p.min_average) and float(project[len(project)-2]) <= float(control_p.max_average):}}
											<span class="badge badge-warning">
										{{else:}}
											<span class="badge badge-success">
										{{pass}}
										    {{=project[len(project) - 2]}}
										    </span>
									</center>
								</td>
								<td>
									<center>
										{{if float(project[len(project)-1]) < float(control_p.min_average):}}
											<span class="badge badge-danger">
										{{elif float(project[len(project)-1]) >= float(control_p.min_average) and float(project[len(project)-1]) <= float(control_p.max_average):}}
											<span class="badge badge-warning">
										{{else:}}
											<span class="badge badge-success">
										{{pass}}
                                            {{=project[len(project) - 1]}}
                                            </span>
									</center>
								</td>
							{{pass}}
							{{first = False}}
						</tr>
					{{pass}}
				</table>
				<!--BODY OF REPORT-->
				<!--REPORT CONTENTS-->    
			</div>
		</div>
	</div>
</div>

{{block page_js}}
<script type="text/javascript">
	function exportCSV(){
		window.location.href = "{{=URL('school_reports', 'general_period_export', vars=dict(list_type='csv', period=period.id))}}";
	}
</script>
{{end page_js}}
