{{extend 'dashboard.html'}}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
<style>
  p {
    white-space: pre-line;
  }
</style>
<div class="dttContainer">
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <h1 style="color: white">{{=ofe[0]['puesto']}}</h1>
        </div>
    </nav>
    <br><br>
    <div class="row">
        <div class="col">
            <div class="card bg-light" style="max-width: 75rem;">
                <div class="card-header text-white bg-dark">
                    <h5>Descripción <i class="bi bi-layout-text-sidebar-reverse"></i></h5>
                </div>
                <div class="card-body">
                    {{inc_vars = dict(
                            editable=False,
                            edit_action='',
                            delete_action='',
                            content=MARKMIN(description_content, markmin_settings)
                        )
                    }}
                    {{include 'include/content_view_bt.html'}}
                </div>
                <div class="card-header text-white bg-dark">
                    <h5>Requerimientos <i class="bi bi-card-checklist"></i></h5>
                </div>
                <div class="card-body">
                    {{inc_vars = dict(
                            editable=False,
                            edit_action='',
                            delete_action='',
                            content=MARKMIN(requerimientos, markmin_settings)
                        )
                    }}
                    {{include 'include/content_view_bt.html'}}
                </div>
                <div class="card-header text-white bg-dark">
                    <h5>Salario <i class="bi bi-cash"></i></h5>
                </div>
                <div class="card-body">
                    <h5>{{=ofe[0]['salario_aproximado']}}</h5>
                </div>
            </div>
        </div>
        <div class="col-4">
            <button type="button" onclick="sendCV()" class="btn btn-primary">Enviar mi CV</button><br><br>
            <div class="card position-fixed" style="width: 18rem;">
                <div class="card-body">
                    <h5 class="card-header text-white bg-dark">Resumen de empleo</h5>
                    <p class="card-text">Puesto: {{=ofe[0]['puesto']}}</p>
                    <h6 lass="card-text">Empresa:</h6>
                    <a style="cursor:pointer;" class="link-secondary"
                    href="{{=URL('lista_oferta', 'vista_empresa', vars=dict( num = ofe[0]['id_empresa']*720316 + 424686))}}">
                        {{=ofe[0]['nombre_empresa']}}
                    </a>
                    <br><br>
                    <h6 class="card-text"> Salario: </h6>
                    <p class="card-text">{{=ofe[0]['salario_aproximado']}}</p>
                    <button type="button" onclick="sendCV()" class="btn btn-primary">Enviar mi CV</button><br><br>
                </div>
            </div>
        </div>
    </div>
</div>

{{block page_js}}
    <script type="text/javascript" src="{{=URL('static','markitup')}}/jquery.markitup.pack.js"></script>
    <script type="text/javascript" src="{{=URL('static','markitup')}}/sets/markmin/set.js"></script>
    <link rel="stylesheet" type="text/css" href="{{=URL('static','markitup')}}/skins/markitup/style.css" />
    <link rel="stylesheet" type="text/css" href="{{=URL('static','markitup')}}/sets/markmin/style.css" />
    <!-- Enable Markmin in textarea -->
    <script>
        jQuery(document).ready(function () {
            jQuery('textarea').css('width', '500px').css('height', '200px').markItUp(mySettings);
            jQuery('h1').each(function () {
                if ($(this).html() == 'Contenido') {
                    $(this).addClass('noprint');
                }
            });
            var i = 0;
            jQuery('.well.span12 h2').each(function () {
                if ($(this).html() == 'PRACTICA' || $(this).html() == 'HOJA DE TRABAJO' || $(this).html() == 'TAREA' || $(this).html() == 'EXAMEN FINAL' || $(this).html() == 'OTRA ACTIVIDAD' || $(this).html() == 'Reporte Final de Semestre') {
                    if (i > 0)
                    $(this).parent().parent().addClass('breakpage');
                    i++;
                }
            });
            jQuery('.span12 h1').each(function () {
                if ($(this).html() == 'Conclusiones') {
                    if (i > 0)
                    $(this).parent().parent().parent().addClass('breakpage');
                    i++;
                }
            });
            jQuery('h1').each(function () {
                if ($(this).html() == 'Introducción') {
                    $(this).addClass('breakpage');
                }
            });
        });
    </script>
    <!-- //Enable Markmin in textarea -->
    <script>
        function sendCV() {
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const id = urlParams.get('num')
            const data = {
                id: id,
                nombre: 'hola'
            }
            $.ajax({
                type: 'post',
                url: '/lista_oferta/registro_solicitud',
                data: `array=${JSON.stringify(data)}`,
                success: function (res) {
                    res = JSON.parse(res);
                    if (res.success) {
                        Swal.fire({
                            title: 'Tu CV ha sido enviado exitosamente!',
                            text: res.msg,
                            icon: 'success'
                        }).then(() => window.location = '/lista_oferta/seguimiento_sol');
                    } else {
                        Swal.fire({
                            title: 'Error!',
                            text: res.msg,
                            icon: 'error'
                        });
                    }
                },
                error: function (xhr, status, errorThrown) {
                    Swal.fire({
                        title: 'Error!',
                        text: 'Hubo un problema, intente más tarde',
                        icon: 'error'
                    });
                }
            });
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
{{end page_js}}