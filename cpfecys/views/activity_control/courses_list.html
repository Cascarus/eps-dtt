{{extend 'dashboard.html'}}
{{import cpfecys}}
{{step_count = 0}}
<div class="col-12">
	<div class="dttContainer">
		<center>
			{{if auth.has_membership('Super-Administrator') or (auth.has_membership('Ecys-Administrator') & ecys_var):}}
				<h2>Control academico</h2>
				<h5>{{=T(periodo.period.name)}} {{=periodo.yearp}}</h5>
			{{else:}}
				<h1>Mis cursos
					<br>
					<small>{{=T(periodo.period.name)}} {{=periodo.yearp}}</small>
				</h1>
			{{pass}}
		</center>
		
	<div class="row mt-3">
		{{if (auth.has_membership('Teacher') and not ecys_var) and (str(periodo.id) == str(currentyear_period.id)):}}
			<div class="col-12 mb-5">
				<a class="btn btn-primary" data-toggle="collapse" href="#multiCollapseExample1" role="button" aria-expanded="false" aria-controls="multiCollapseExample1">Reportes</a>
				<div class="row">
					<div class="col">
						<div class="collapse multi-collapse" id="multiCollapseExample1">
							<div class="card card-body">
								<ul class="list-group">
									<li class="list-group-item">
										<a href="{{=URL('teacher_reports', 'grades_management')}}" type="button"
											class="btn btn-secondary" id="menu_create_activity">{{=T('Report management grades')}}</a>
									</li>
									<li class="list-group-item">
										<a href="{{=URL('teacher_reports','validate_laboratory_management')}}"
											type="button" class="btn btn-secondary">{{=T('Management Reports Laboratory Revalidations')}}</a>
									</li>
									<li class="list-group-item">
										<a href="{{=URL('teacher_reports','laboratory_replacing_management')}}"
											type="button" class="btn btn-secondary">{{=T('Report Equivalence Management Laboratory')}}</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		{{pass}}
		<div class="col-12 col-md-6 mb-3">
			<div data-step="{{step_count+=1}}{{=step_count}}" data-intro="En esta secci칩n podr치 seleccionar el semestre que desea visualizar.">
				<form class="form-inline" action="{{=URL('activity_control', 'courses_list')}}" method='get'>
					<select name="period" id="period-courses" class="form-control">
						<!--emarquez: id periodo-->
						{{var_sel = ''}}
						{{for period in periods:}}
							{{if period.id == periodo.id:}}
								{{var_sel = "selected='selected'"}}
							{{else:}}
								{{var_sel = ''}}
							{{pass}}
							<option value="{{=period.id}}" {{=var_sel}}>
								{{=T(period.period.name)}} - {{=period.yearp}}
							</option>
						{{pass}}
					</select>
					<input class="btn btn-outline-primary" type="submit" value="{{=T('Go')}}">
					<!--emarquez: control de periodo , -->
					<input id="chkTipoCursoA" type="checkbox" checked data-toggle="toggle" data-on="Semestres" data-off="Periodos" data-size="mini" class="d-none">
				</form>
			</div>
		</div>
		<div class="col-12 col-md-6 border p-1 mb-3">
			<div class="text-right row">
				<div class="col-4">
					<span class="dtt__label badge badge-success">&nbsp;&nbsp;&nbsp;</span>
					<span>{{=T('Notes above average')}}</span>
				</div>
				<div class="col-4">
					<span class="dtt__label badge badge-warning">&nbsp;&nbsp;&nbsp;</span>
					<span>{{=T('Notes on the average')}}</span>
				</div>
				<div class="col-4">
					<span class="dtt__label badge badge-danger">&nbsp;&nbsp;&nbsp;</span>
					<span>{{=T('Notes Below Average')}}</span>
				</div>
			</div>
		</div>
	</div>

	{{if (auth.has_membership('Teacher') and not ecys_var) or auth.has_membership('Super-Administrator') or auth.has_membership('Ecys-Administrator'):}}
		{{if auth.has_membership('Super-Administrator') or (auth.has_membership('Ecys-Administrator') & ecys_var):}}
			<div class="dttcourses mt-4 first">
				<div class="row">
					<div class="col-12">
						<div id="table-first" class="table-responsive">
							<table class="table table-striped table-bordered">
								<thead>
									<tr>
										<th width="50%">{{=T('Course')}}</th>
										<th width="20%"><center>{{=T('Section')}}<br><br></center></th>
										<th width="10%" style="white-space:inherit;"><center>{{=T('Course Average')}}</center></th>
										<th width="10%" style="white-space:inherit;"><center>{{=T('Laboratory Average')}}</center></th>
										<th width="10%"><center>{{=T('Grades Management')}}<br><br></center></th>
										{{if periodo == period:}}
											<th width="10%"><center>{{=T('Asignaci칩n de estudiantes')}}<br><br></center></th>
										{{pass}}
									</tr>
								</thead>
		{{pass}}
			<tbody>
				{{var_do = True}}
				{{var_admin = False}}
				{{if auth.has_membership('Super-Administrator') or auth.has_membership('Ecys-Administrator'):}}
					{{comparation = T(period.period.name)+" "+str(period.yearp)}}
					{{controlP = db((db.student_control_period.period_name==comparation)).select().first()}}
					{{var_admin = True}}
				{{pass}}
				{{for course in coursesAdmin:}}
						<tr>
							{{if var_admin == False:}}
								<div class="row">
									<div class="col-12">
										<div class="navbar">
											<div class="heading">
												<a style="cursor:pointer;" onclick="click_project_{{=course.user_project.project}}()">
													<h4>{{=split_name(course.user_project.project.name)}}</h4>
												</a>
												<script type="text/javascript">
													function click_project_{{=course.user_project.project}}(){
														$("#div_course_{{=course.user_project.project}}").toggle(300);
													}
												</script>
											</div>
										</div>
									</div>
								</div>
								<div class="well" id="div_course_{{=course.user_project.project}}">
									<div class="row">
										<div class="col-12">
											<p>{{=T('Section')}}:
												{{=split_section(course.user_project.project.name)}}</p>
										</div>
							{{else:}}
								{{try:}}
									<td>
										<p>{{=split_name(course[1])}}</p>
									</td>
									<td>
										<p>{{=split_section(course[1])}}</p>
									</td>
									<td>
										<div class="text-center">
											
											{{if course[2] < float(controlP.min_average):}}
												<span class="dtt__label badge badge-danger">
													{{=round(course[2], 2)}}
												</span>
											{{elif course[2] >= float(controlP.min_average) and course[2] <= float(controlP.max_average):}}
												<span class="dtt__label badge badge-warning">
													{{=round(course[2], 2)}}
												</span>
											{{else:}}
												<span class="dtt__label badge badge-success">
													{{=round(course[2], 2)}}
												</span>
											{{pass}}
										</div>
									</td>
									<td>
										<div class="text-center">
											{{if course[3] < float(controlP.min_average):}}
												<span class="dtt__label badge badge-danger">
													{{=round(course[3],2)}}
												</span>
											{{elif course[3] >= float(controlP.min_average) and course[3] <= float(controlP.max_average):}}
												<span class="dtt__label badge badge-warning">
													{{=round(course[3],2)}}
												</span>
											{{else:}}
												<span class="dtt__label badge badge-success">
													{{=round(course[3],2)}}
												</span>
											{{pass}}
										</div>
									</td>
								{{except:}}
									{{...}}
								{{pass}}
							{{pass}}
							{{if var_admin == True:}}
								<td>
									<a title="{{=T('Grades Management')}}" class="btn btn-info"
										href="{{=URL('activity_control', 'students_control', vars=dict(project = course[0], period=periodo.id))}}">
										<i class="fa fa-pencil-square" aria-hidden="true"></i>
									</a>
								</td>
								<td>
									{{if periodo == period:}}
										<div class="col-6 col-md-4 mb-2">
											<a title="{{=T('Asignaci칩n')}}" class="btn btn-info"
												href="{{=URL('student_academic', 'academic_assignation', vars=dict(project = course[0], year_period=periodo.id))}}">
												<i class="fa fa-users" aria-hidden="true"></i>
											</a>
										</div>
									{{pass}}
									{{else:}}
										<div class="col-6 col-md-4 mb-2">
											{{assignation_var = db((db.user_project.assigned_user == auth.user.id) & (db.user_project.period == course.period_year.id) 
																& (db.user_project.project==course.user_project.project)).select(db.user_project.ALL).first()}}
											<a class="dttbtn"
												href="{{=URL('student_academic', 'academic_assignation', vars=dict(assignation = assignation_var.id, year_period = str(periodo.id)))}}">
												<span class="btn btn-info">
													<i class="fa fa-users" aria-hidden="true"></i>
												</span>
												{{=T('List of Students')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('activity_control', 'students_control', vars=dict( project = course.user_project.project, period=periodo.id))}}">
												<span class="btn btn-info">
													<i class="fa fa-pencil-square-o" aria-hidden="true"></i>
												</span>
												{{=T('Grades Management')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('notification', 'teacher_mail_notifications', vars=dict(assignation = assignation_var.id, period = periodo.id))}}">
												<span class="btn btn-info">
													<i class="fa fa-paper-plane" aria-hidden="true"></i>
												</span>
												{{=T('Send Notice')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('notification', 'teacher_register_mail_notifications', vars=dict( project = course.user_project.project, period=periodo.id, type = 'course_list'))}}">
												<span class="btn btn-info">
													<i class="fa fa-envelope-open" aria-hidden="true"></i>
												</span>
												{{=T('Register Notices')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('library', 'file_managers', vars=dict(pro=assignation_var.id, tipo='3', semester=periodo.id))}}">
												<span class="btn btn-info">
													<i class="fa fa-folder-open" aria-hidden="true"></i>
												</span>
												{{=T('Library')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('teacher', 'students', vars=dict( project = course.user_project.project, year_period=periodo.id))}}">
												<span class="btn btn-info">
													<i class="fa fa-users" aria-hidden="true"></i>
												</span>
												{{=T('Show Students')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn" href="{{=URL('teacher', 'graphs', vars=dict( project = course.user_project.project, year_period=periodo.id))}}">
												<span class="btn btn-info">
													<i class="fa fa-line-chart" aria-hidden="true"></i>
												</span>
												{{=T('Show Statistics')}}
											</a>
										</div>
										{{if str(periodo.id) == str(currentyear_period.id):}}
											<div class="col-12 col-md-4 mb-2">
												{{
													tempReports = []
													var_count_report = 00
													my_projects = db((db.user_project.assigned_user == auth.user.id)&(db.project.id == db.user_project.project)).select()
													for project in my_projects:
														for assignation in project.project.user_project.select():
															if assignation.project.id == course.user_project.project:
																teacher_var = db((db.user_project.project == assignation.project) & (db.user_project.assigned_user == db.auth_user.id)
																			& (db.auth_membership.user_id == db.auth_user.id) & (db.auth_membership.group_id == db.auth_group.id)
																			& (db.auth_group.role == 'Teacher')).select().last()
																if teacher_var is not None:
																	if teacher_var.user_project.assigned_user == auth.user.id:
																		q = ((assignation.report((db.report.status == db.report_status.id)&((db.report_status.name == 'Grading') | (db.report_status.name == 'EnabledForTeacher')))))
																		for report in q.select():
																			tempReports.append(report.report.id)
																			var_count_report += 1
																		pass
																	pass
																pass
															pass
														pass
													pass
												}}
												<a class="dttbtn" href="{{=URL('teacher', 'todo_reports', vars=dict(project = course.user_project.project, type='list'))}}">
													<span class="btn btn-info">
														<i class="fa fa-line-chart" aria-hidden="true"></i>
													</span>
													{{=T('Grade Pending Reports')}} ({{=var_count_report}})
												</a>
											</div>
											<div class="col-12 col-md-4 mb-2">
												{{
													var_count = 0
													var_count += db((db.request_change_weighting.status == 'pending') & (db.request_change_weighting.period == cpfecys.current_year_period().id)
																& (db.request_change_weighting.project == course.user_project.project)).count()
													var_count += db((db.requestchange_activity.status == 'pending') & (db.requestchange_activity.semester == cpfecys.current_year_period().id)
																& (db.requestchange_activity.course == course.user_project.project)).count()
													var_count += db((db.request_change_grades.status == 'pending') & (db.request_change_grades.period == cpfecys.current_year_period().id)
																& (db.request_change_grades.project == course.user_project.project)).count()
												}}
												<a class="dttbtn" href="{{=URL('activity_control', 'courses_list_request', vars=dict(project = course.user_project.project, type='list'))}}">
													<span class="btn btn-info">
														<i class="fa fa-line-chart" aria-hidden="true"></i>
													</span>
													{{=T('Request Control')}} ({{=var_count}})
												</a>
											</div>
										{{pass}}
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn" href="{{=URL('evaluation', 'evaluation_list', vars=dict(project = course.user_project.project, period=periodo.id))}}">
												<span class="btn btn-info">
													<i class="fa fa-list-alt" aria-hidden="true"></i>
												</span>
												Desempe침o 360
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn" href="{{=URL('iso_ev_rendimiento', 'mostrar_resultados', vars=dict(periodo=periodo.id, id_project=course.user_project.project))}}">
												<span class="btn btn-info">
													<i class="fa fa-list-alt" aria-hidden="true"></i>
												</span>
												Evaluaci칩n de Rendimiento
											</a>
										</div>		
										<div class="col-12 col-md-4 mb-2">
											{{include 'activity_control/quiz_module.html'}}
										</div>
									</div>
									{{pass}}
								</td>
								{{if (auth.has_membership('Teacher') and ecys_var == False):}}
								{{pass}}
										</div>
										</td>
										{{var_do = False}}
										{{pass}}

									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
			{{else:}}
			{{if countcoursesAdminT > 0:}}
			<div class="dttcourses mt-4 y">
				{{var_do=True}}
				{{for course in coursesAdmin:}}
				<div class="row">
					<div class="col-12">
						<div class="heading">
							<a style="cursor:pointer;"
								onclick="click_project_student_{{=course.user_project.project}}()">
								<h5>{{=split_name(course.user_project.project.name)}}</h5>
							</a>
							<script type="text/javascript">
								function click_project_student_{{=course.user_project.project}}(){
									$("#div_course_student_{{=course.user_project.project}}").toggle(300);
								}
							</script>
						</div>
					</div>
					<div class="col-12 well" id="div_course_student_{{=course.user_project.project}}">
						<div class="row">

							<div class="col-12 col-md-4">
								<h6><strong>{{=T('Section')}}:</strong>
									{{=split_section(course.user_project.project.name)}}</h6>
								<h6><strong>{{=T('Membership')}}:</strong> {{=T('Rol Student')}}</h6>
							</div>
							<div class="col-12 col-md-8">
								<div class="row">
									<div class="col-6 col-md-4 mb-2">
										{{assignation_var = db((db.user_project.assigned_user==auth.user.id)&\
										(db.user_project.period == course.period_year.id) & \
										(db.user_project.project==course.user_project.project)).select(db.user_project.ALL).first()}}

										<a class="dttbtn"
											href="{{=URL('student_academic', 'academic_assignation', vars=dict(assignation = assignation_var.id, year_period = str(periodo.id)))}}">
											<span class="btn btn-info"><i class="fa fa-users"
													aria-hidden="true"></i></span>
											{{=T('List of Students')}}
										</a>
									</div>
									<div class="col-12 col-md-4 mb-2">
										<a class="dttbtn"
											href="{{=URL('activity_control', 'students_control', vars=dict( project = course.user_project.project, period=periodo.id))}}">
											<span class="btn btn-info"><i class="fa fa-pencil-square-o"
													aria-hidden="true"></i></span>
											{{=T('Grades Management')}}
										</a>
									</div>
									<div class="col-12 col-md-4 mb-2">
										<a class="dttbtn"
											href="{{=URL('notification', 'mail_notifications', vars=dict(assignation=assignation_var.id, period=periodo.id))}}">
											<span class="btn btn-info"><i class="fa fa-paper-plane"
													aria-hidden="true"></i></span>

											{{=T('Send Notice')}}
										</a>
									</div>
									<div class="col-12 col-md-4 mb-2">
										<a class="dttbtn"
											href="{{=URL('notification', 'register_mail_notifications', vars=dict( project = course.user_project.project, period=periodo.id, type = 'course_list'))}}">
											<span class="btn btn-info"><i class="fa fa-envelope-open"
													aria-hidden="true"></i></i></span>
											{{=T('Register Notices')}}
										</a>
									</div>
									<div class="col-12 col-md-4 mb-2">
										<a class="dttbtn"
											href="{{=URL('library', 'file_managers', vars=dict( pro = assignation_var.id, tipo='3', semester = periodo.id))}}">
											<span class="btn btn-info"><i class="fa fa-folder-open"
													aria-hidden="true"></i></span>
											{{=T('Library')}}
										</a>
									</div>
									<div class="col-12 col-md-4 mb-2">
										<a class="dttbtn"
											href="{{=URL('eventos', 'events_list', vars=dict( assignation = assignation_var.id))}}">
											<span class="btn btn-info"><i class="fa fa-calendar"
													aria-hidden="true"></i></span>
											{{=T('Manage events')}}
										</a>
									</div>
									<div class="col-12 col-md-4 mb-2">
										<a class="dttbtn"
											href="{{=URL('activity_control', 'graphs', vars=dict( project = course.user_project.project, year_period=periodo.id))}}">
											<span class="btn btn-info"><i class="fa fa-line-chart"
													aria-hidden="true"></i></span>
											{{=T('Show Statistics')}}
										</a>
									</div>
									<div class="col-12 col-md-4 mb-2">
										<a class="dttbtn"
											href="{{=URL('evaluation', 'evaluation_list', vars=dict( project = course.user_project.project, period=periodo.id))}}">
											<span class="btn btn-info"><i class="fa fa-list-alt"
													aria-hidden="true"></i></span>
											Desempe침o 360
										</a>
									</div>
									<div class="col-12 col-md-4 mb-2">
										{{include 'activity_control/quiz_module.html'}}
									</div>
								</div>
							</div>
						</div>
					</div>
					{{var_do=False}}
					{{pass}}
				</div>
				{{pass}}


				{{if coursesStudentT>0:}}
				<div class="dttcourses mt-4 z">
					{{var_do=True}}
					{{for course in coursesStudent:}}
					<div class="row">
						<div class="col-12">
							<div class="heading">
								<a style="cursor:pointer;"
									onclick="click_project_academic_{{=course.academic_course_assignation.assignation}}()">
									<h5>{{=split_name(course.academic_course_assignation.assignation.name)}}</h5>
								  <h6>{{ encuesta = consultar_evaluacion(course)}}</h6>
								</a>
								<script type="text/javascript">
									function click_project_academic_{{=course.academic_course_assignation.assignation}}(){
										$("#div_course_academic_{{=course.academic_course_assignation.assignation}}").toggle(300);
									}
								</script>
							</div>
						</div>
						<div class="col-12 well"
							id="div_course_academic_{{=course.academic_course_assignation.assignation}}">
							<div class="row">
								<div class="col-12 col-md-4">
									<b>{{=T('Section')}}:</b>
									{{=split_section(course.academic_course_assignation.assignation.name)}}
									<b>{{=T('Membership')}}:</b> {{=T('Student')}}
								</div>
								<div class="col-12 col-md-8">
                  {{if len(encuesta['encuesta']) == 0 or encuesta['completada']:}}
									  <div class="row">
										  <div class="col-12 col-md-4 mb-2">
										  	<a class="dttbtn"
										  		href="{{=URL('activity_control', 'students_control', vars=dict( project = course.academic_course_assignation.assignation.id, period=periodo.id))}}">
										  		<span class="btn btn-info"><i class="fa fa-list-alt"
										  				aria-hidden="true"></i></span>
										  		{{=T('View my Grades')}}
										  	</a>
										</div>
										{{if auth.has_membership('Academic'):}}
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('notification_student', 'send_mail', vars=dict(project=course.academic_course_assignation.assignation.id, semester_id=periodo.id))}}">
												<span class="btn btn-info"><i class="fa fa-paper-plane"
														aria-hidden="true"></i></i></span>
												{{=T('Send Message')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('notification_student', 'sent_mails', vars=dict(project=course.academic_course_assignation.assignation.id, period=periodo.id, type='acadmic_control'))}}">
												<span class="btn btn-info"><i class="fa fa-envelope-open"
														aria-hidden="true"></i></i></span>
												{{=T('Sent Messages')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('library', 'file_managers', vars=dict( pro = course.academic_course_assignation.assignation.id, semester = periodo.id, tipo = '5'))}}">
												<span class="btn btn-info"><i class="fa fa-folder-open"
														aria-hidden="true"></i></i></span>
												{{=T('Library')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('activity_control', 'graphs', vars=dict( project = course.academic_course_assignation.assignation.id, year_period=periodo.id))}}">
												<span class="btn btn-info"><i class="fa fa-line-chart"
														aria-hidden="true"></i></i></span>
												{{=T('Show Statistics')}}
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											<a class="dttbtn"
												href="{{=URL('evaluation', 'evaluation_list', vars=dict(project = course.academic_course_assignation.assignation.id, period=periodo.id))}}">
												<span class="btn btn-info"><i class="fa fa-list-alt"
														aria-hidden="true"></i></span>
												Desempe침o 360
											</a>
										</div>
										<div class="col-12 col-md-4 mb-2">
											{{include 'activity_control/quiz_module2.html'}}
										</div>
					          <!--ISO-->
										<div class="col-12 col-md-4 mb-2">
										  <a class="dttbtn" href="{{=URL('iso_reporte_incidente', 'reportar', vars=dict(project=course.academic_course_assignation.assignation.id, periodo=periodo.id))}}">
											  <span class="btn btn-info"><i class="fa fa-calendar-times-o" aria-hidden="true"></i></span>
											  Reportar Incidente
											</a>
										</div>
					          <!--ISO-->
										{{pass}}
					  			</div>
				          {{else:}}
				            <div class="row">
				              <div class="col-12">
				                <h4>
				                  La evaluaci칩n de rendimiento estar치 activa
				                </h4>
				                <h5>
				                  del {{=encuesta['encuesta'][0][1].strftime('%d/%m/%Y')}} al {{=encuesta['encuesta'][0][2].strftime('%d/%m/%Y')}}
				                </h5>
				              </div>
                      {{for enc in encuesta['encuesta']:}}
							  {{if enc[8] < enc[7]:}}
				                	<div class="col-12 col-md-4 mb-2">
				                  		<a class="dttbtn" href="{{=URL('iso_ev_rendimiento', 'responder_evaluacion')}}/{{=enc[3]}}">
				                    		<span class="btn btn-info"><i class="fa fa-bar-chart" aria-hidden="true"></i></span>
                            				Evaluar a: {{=enc[5] + " " + enc[6]}}
				                  		</a>
				                	</div>
								{{pass}}
				              {{pass}}
				            </div>
                  {{pass}}
								</div>
							</div>
						</div>
					</div>
					{{var_do=False}}
					{{pass}}
				</div>
				{{pass}}

				{{if countcoursesAdminT==0 and coursesStudentT==0:}}
					<div class="dttcourses mt-4">
						<div class="row">
							<div class="col-12 text-center">
								<h3>No tiene asignaciones</h3>
							</div>
						</div>
					</div>
				{{pass}}
				{{pass}}
			</div>
		</div>
		
<script type="text/javascript">
	{{from gluon.serializers import json}}
	
	var periodos_s = {{=XML(json(periods))}};
	var periodos_v = {{=XML(json(periods_var))}};
	var period_all = {{=XML(json(period_all))}};
	var period = {{=XML(json(period))}};
	var periodo = {{=XML(json(periodo))}};
	var periodo_year = {{=XML(json(periodo_year))}};
	var period_detail = {{=XML(json(period_detail))}};
	var periodo_parametro = {{=XML(json(periodo_parametro))}};
	var countcoursesAdminT = {{=XML(json(countcoursesAdminT))}};
	var coursesStudent = {{=XML(json(coursesStudent))}};
	var coursesStudentT = {{=XML(json(coursesStudentT))}};
	var coursesAdmin = {{=XML(json(coursesAdmin))}};
	var coursesAdminAnterior = {{=XML(json(coursesAdminAnterior))}};
	
	$(document).ready(function () {
		$("#chkTipoCursoA").change(function() {
			if($(this).prop('checked')) {
				$.ajax({
					url: "{{=URL('activity_control', 'get_periods_on_change', vars=dict(period_type='1', period_id=periodo.id))}}",
					type: 'GET',
					success: function(resp) {
						$("#period-courses").empty();
						for (let element of resp){
							$("#period-courses").append(element)
						}
					},
					cache: false,
					contentType: false,
					processData: false
            	});
			} else {
				$.ajax({
					url: "{{=URL('activity_control', 'get_periods_on_change', vars=dict(period_type='2', period_id=periodo.id))}}",
					type: 'GET',
					success: function(resp) {
						$("#period-courses").empty();
						for (let element of resp){
							$("#period-courses").append(element)
						}
					},
					cache: false,
					contentType: false,
					processData: false
            	});
			}
		})
	});
</script>