{{extend 'dashboard.html'}}
<h1>Resultado Evaluaci√≥n</h1>
<h2>{{=tutor.username}} - {{=tutor.first_name}} {{=tutor.last_name}}</h2>
<br />
<br />
<style>
    .highcharts-figure,
    .highcharts-data-table table {
        min-width: 320px;
        max-width: 800px;
        margin: 1em auto;
    }

    .highcharts-data-table table {
        font-family: Verdana, sans-serif;
        border-collapse: collapse;
        border: 1px solid #EBEBEB;
        margin: 10px auto;
        text-align: center;
        width: 100%;
        max-width: 500px;
    }

    .highcharts-data-table caption {
        padding: 1em 0;
        font-size: 1.2em;
        color: #555;
    }

    .highcharts-data-table th {
        font-weight: 600;
        padding: 0.5em;
    }

    .highcharts-data-table td,
    .highcharts-data-table th,
    .highcharts-data-table caption {
        padding: 0.5em;
    }

    .highcharts-data-table thead tr,
    .highcharts-data-table tr:nth-child(even) {
        background: #f8f8f8;
    }

    .highcharts-data-table tr:hover {
        background: #f1f7ff;
    }


    input[type="number"] {
        min-width: 50px;
    }
</style>
<div class="web2py_grid">
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>

    <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
            {{activo=True}}
            {{ for pregunta in lista:}}
                <div class="carousel-item {{if activo:}} active {{activo=False}}{{pass}}">
                    <figure class="highcharts-figure">
                        <div id="container{{=pregunta['idpregunta']}}"></div>
                        <p class="highcharts-description">
                            Respuestas
                        </p>
                    </figure>
                    <script type="text/javascript">
                        Highcharts.chart('container{{=pregunta["idpregunta"]}}', {
                            chart: {
                                plotBackgroundColor: null,
                                plotBorderWidth: null,
                                plotShadow: false,
                                type: 'pie'
                            },
                            title: {
                                text: 'Pregunta: {{=pregunta["pregunta"]}}'
                            },
                            tooltip: {
                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                            },
                            accessibility: {
                                point: {
                                    valueSuffix: '%'
                                }
                            },
                            plotOptions: {
                                pie: {
                                    allowPointSelect: true,
                                    cursor: 'pointer',
                                    dataLabels: {
                                        enabled: true,
                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                                    }
                                }
                            },
                            series: [{
                                name: 'Respuesta',
                                colorByPoint: true,
                                data: [
                                    {{ if pregunta['tipo_pregunta'] == 1: }}
                                        {{ for li in pregunta['respuesta']: }}
                                            {
                                                name: '{{=li[1]}}',
                                                y: {{=li[0]/li[1]}}
                                            },
                                        {{ pass }}
                                    {{ elif pregunta['tipo_pregunta']== 2: }}
                                        {{ for li in pregunta['respuesta']: }}
                                            {
                                                name: '{{=li[0]}}',
                                                y: {{=li[2]}}
                                            },
                                        {{ pass }}
                                    {{ pass }}
                                ]
                            }]
                        });
                    </script>
                </div>
            {{pass}}
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev"
            style="background: #fc7204; width: 50px;">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only" style="color:black">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next"
            style="background:#fc7204; width:50px;">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
    {{for coment in comentario:}}
        <br />
        <br />
        <div class="card">
            <h5 class="card-header">{{=coment['pregunta']}}</h5>
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {{for resp in coment['respuesta']:}}
                        <li class="list-group-item">{{=resp[0]}}</li>
                    {{pass}}
                </ul>
            </div>
        </div>
    {{pass}}
</div>