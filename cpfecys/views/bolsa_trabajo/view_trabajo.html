{{extend 'dashboard.html'}}

<div class='row p-0 m-0'>
    <div class='d-flex w-100 justify-content-center py-3 px-0'>
        <h1 class='p-0 m-0'>{{=new_dict["trabajo"]["puesto"]}}</h1>
    </div>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/cpfecys/bolsa_trabajo/trabajos">Ofertas Laborales</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{=new_dict["trabajo"]["puesto"]}}</li>
    </ol>
</nav>

<div class='row m-0 p-0'>
    <button type="button" class="btn btn-primary mr-3" onclick="edit()">Editar</button>
    <button type="button" class="btn btn-danger" onclick="eliminar()">Eliminar</button>
</div>

<table class="table table-striped table-hover">
    <tbody>
        <tr>
            <th scope="row">ID</th>
            <td>{{=new_dict["trabajo"]["id_oferta_laboral"]}}</td>
        </tr>
        <tr>
            <th scope="row">Nombre del puesto</th>
            <td>{{=new_dict["trabajo"]["puesto"]}}</td>
        </tr>
        <tr>
            <th scope="row">Descripción</th>
            <td>{{=new_dict["trabajo"]["descripcion"]}}</td>
        </tr>
        <tr>
            <th scope="row">Salario Apróximado</th>
            <td>Q. {{=new_dict["trabajo"]["salario_aproximado"]}}</td>
        </tr>
        <tr>
            <th scope="row">Fecha Inicio</th>
            <td>{{=new_dict["trabajo"]["fecha_inicio"]}}</td>
        </tr>
        <tr>
            <th scope="row">Fecha Vigencia</th>
            <td>{{=new_dict["trabajo"]["fecha_vigencia"]}}</td>
        </tr>
        <tr>
            <th scope="row">Visitas</th>
            <td>{{=new_dict["trabajo"]["visitas"]}}</td>
        </tr>
        {{if new_dict['trabajo']['banner']:}}
        <tr>
            <th scope="row">Banner</th>
            <td><a href="/cpfecys/static/bolsa_trabajo/ofertas/{{=new_dict['trabajo']['banner']}}" target='_blank'>Ver Banner</a></td>
        </tr>
        {{pass}}
        <tr>
            <th scope="row">Periodo de Creación</th>
            <td>Semestre {{=new_dict["trabajo"]["period"]}} - Año {{=new_dict["trabajo"]["yearp"]}}</td>
        </tr>
        <tr>
            <th scope="row">Empresa Encargada</th>
            <td>{{=new_dict["trabajo"]["nombre_empresa"]}} - Tel. {{=new_dict["trabajo"]["telefono"]}}</td>
        </tr>
        <tr>
            <th scope="row">Area de Especialidad</th>
            <td>{{=new_dict["trabajo"]["area_especialidad"]}}</td>
        </tr>
        <tr>
            <th scope="row">Estado Oferta Laboral</th>
            <td>{{=new_dict["trabajo"]["estado_oferta_laboral"]}}</td>
        </tr>
        <tr>
            <th scope="row">Motivo Rechazo</th>
            <td>{{=new_dict["trabajo"]["motivo_rechazo"]}}</td>
        </tr>
    </tbody>
</table>

<script>
    function edit() {
        window.location = `${location.protocol}//${location.hostname}:${location.port}/cpfecys/bolsa_trabajo/editar_trabajo?id={{=new_dict['trabajo']['id_oferta_laboral']}}`
    }

    function eliminar() {
        Swal.fire({
            title: 'Eliminar',
            text: 'Seguro que desea eliminar a la oferta laboral: {{=new_dict["trabajo"]["puesto"]}}',
            icon: 'question',
            showDenyButton: true,
            confirmButtonText: 'Eliminar',
            denyButtonText: `Cancelar`,
        }).then((result) => {
            if (result.isConfirmed) {
                const data = {
                    "id_oferta_laboral": Number('{{=new_dict["trabajo"]["id_oferta_laboral"]}}')
                }
                $.ajax({
                    type: 'post',
                    url: `${location.protocol}//${location.hostname}:${location.port}/cpfecys/bolsa_trabajo/eliminar_trabajo`,
                    data: `array=${JSON.stringify(data)}`,
                    success: function (res) {
                        res = JSON.parse(res);
                        if (res.success) {
                            Swal.fire({
                                title: 'Eliminado!',
                                text: res.msg,
                                icon: 'success'
                            }).then(() => {
                                window.location = `${location.protocol}//${location.hostname}:${location.port}/cpfecys/bolsa_trabajo/trabajos`;
                            });
                        } else {
                            Swal.fire({
                                title: 'Error!',
                                text: res.msg,
                                icon: 'error'
                            });
                        }
                    },
                    error: function (xhr, status, errorThrown) {
                        console.log(xhr, status, errorThrown);
                        Swal.fire({
                            title: 'Error!',
                            text: 'Hubo un problema, intente más tarde',
                            icon: 'error'
                        });
                    }
                });
            }
        });
    }
</script>

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>