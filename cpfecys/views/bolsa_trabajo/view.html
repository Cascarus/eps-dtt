{{extend 'dashboard.html'}}

<div class='row p-0 m-0'>
    <div class='d-flex w-100 justify-content-center py-3 px-0'>
        <h1 class='p-0 m-0'>{{=new_dict["empresa"]["nombre_empresa"]}}</h1>
    </div>
</div>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/cpfecys/bolsa_trabajo/suscripciones">Suscripciones</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{=new_dict["empresa"]["nombre_empresa"]}}</li>
    </ol>
</nav>

<div class='row m-0 p-0'>
    <button type="button" class="btn btn-primary mr-3" onclick="edit()">Editar</button>
    <button type="button" class="btn btn-danger" onclick="eliminar()">Eliminar</button>
</div>

<table class="table table-striped table-hover">
    <tbody>
        <tr>
            <th scope="row">ID</th>
            <td>{{=new_dict["empresa"]["id_empresa"]}}</td>
        </tr>
        <tr>
            <th scope="row">Nombre empresa</th>
            <td>{{=new_dict["empresa"]["nombre_empresa"]}}</td>
        </tr>
        <tr>
            <th scope="row">Correo</th>
            <td>{{=new_dict["empresa"]["correo"]}}</td>
        </tr>
        <tr>
            <th scope="row">Persona encargada</th>
            <td>{{=new_dict["empresa"]["persona_encargada"]}}</td>
        </tr>
        <tr>
            <th scope="row">Direcci칩n</th>
            <td>{{=new_dict["empresa"]["direccion"]}}</td>
        </tr>
        <tr>
            <th scope="row">P치gina web</th>
            <td><a target="_blank"
                    href="{{=new_dict['empresa']['pagina_web']}}">{{=new_dict["empresa"]["pagina_web"]}}</a></td>
        </tr>
        <tr>
            <th scope="row">Descripci칩n</th>
            <td>{{=new_dict["empresa"]["descripcion"]}}</td>
        </tr>
        <tr>
            <th scope="row">Estado</th>
            <td>{{=new_dict["empresa"]["estado_registro"]}}</td>
        </tr>
        <tr>
            <th scope="row">Motivo</th>
            <td>{{=new_dict["empresa"]["motivo_rechazo"]}}</td>
        </tr>
    </tbody>
</table>

<script>
    function edit() {
        window.location = `${location.protocol}//${location.hostname}:${location.port}/cpfecys/bolsa_trabajo/edit?id={{=new_dict['empresa']['id_empresa']}}`
    }

    function eliminar() {
        Swal.fire({
            title: 'Eliminar',
            text: 'Seguro que desea eliminar a la empresa: {{=new_dict["empresa"]["nombre_empresa"]}}',
            icon: 'question',
            showDenyButton: true,
            confirmButtonText: 'Eliminar',
            denyButtonText: `Cancelar`,
        }).then((result) => {
            if (result.isConfirmed) {
                const data = {
                    "id_empresa": Number('{{=new_dict["empresa"]["id_empresa"]}}')
                }
                $.ajax({
                    type: 'post',
                    url: `${location.protocol}//${location.hostname}:${location.port}/cpfecys/bolsa_trabajo/eliminar_empresa`,
                    data: `array=${JSON.stringify(data)}`,
                    success: function (res) {
                        res = JSON.parse(res);
                        if (res.success) {
                            Swal.fire({
                                title: 'Eliminado!',
                                text: res.msg,
                                icon: 'success'
                            }).then(() => {
                                window.location = `${location.protocol}//${location.hostname}:${location.port}/cpfecys/bolsa_trabajo/suscripciones`;
                            });
                        } else {
                            Swal.fire({
                                title: 'Error!',
                                text: res.msg,
                                icon: 'error'
                            });
                        }
                    },
                    error: function (xhr, status, errorThrown) {
                        console.log(xhr, status, errorThrown);
                        Swal.fire({
                            title: 'Error!',
                            text: 'Hubo un problema, intente m치s tarde',
                            icon: 'error'
                        });
                    }
                });
            }
        });
    }
</script>

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>